<!DOCTYPE html>
<html>
<head>
    <title>GitHub Monitor</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f9; padding: 40px; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 600px; margin: auto; }
        .event { border-bottom: 1px solid #eee; padding: 10px 0; }
        .event:last-child { border-bottom: none; }
        .author { font-weight: bold; color: #0366d6; }
        .time { font-size: 0.8em; color: #666; }
    </style>
</head>
<body>
    <div class="card">
        <h2>GitHub Activity Feed</h2>
        <div id="feed">Loading...</div>
    </div>

    <script>
        async function loadEvents() {
            const res = await fetch('/api/latest');
            const data = await res.json();
            const feed = document.getElementById('feed');
            
            if (data.length === 0) {
                feed.innerHTML = "No events found. Push some code!";
                return;
            }

            feed.innerHTML = data.map(ev => `
                <div class="event">
                    <span class="author">${ev.author}</span> 
                    ${ev.action === 'PUSH' ? `pushed to <b>${ev.to_branch}</b>` : 
                      ev.action === 'MERGE' ? `merged <b>${ev.from_branch}</b> to <b>${ev.to_branch}</b>` :
                      `opened PR from <b>${ev.from_branch}</b>`}
                    <div class="time">${ev.timestamp}</div>
                </div>
            `).join('');
        }
        loadEvents();
        setInterval(loadEvents, 15000); // Refresh every 15 seconds
    </script>
</body>
</html>